@{
    var treeList = Html.DevExpress().TreeList(settings =>
    {
        settings.Name = "DiaPhuongTreeList";
        settings.CallbackRouteValues = new { Controller = "DMDiaPhuong", Action = "Load" };

        settings.SettingsEditing.AddNewNodeRouteValues = new { Controller = "DMDiaPhuong", Action = "AddNew" };
        settings.SettingsEditing.UpdateNodeRouteValues = new { Controller = "DMDiaPhuong", Action = "Update" };
        settings.SettingsEditing.DeleteNodeRouteValues = new { Controller = "DMDiaPhuong", Action = "Delete" };
        //settings.SettingsEditing.NodeDragDropRouteValues = new { Controller = "DMDiaPhuong", Action = "Move" };


        /*Settings*/
        settings.SettingsPager.Visible = true;
        settings.SettingsPager.PageSizeItemSettings.Visible = true;
        settings.SettingsPager.PageSizeItemSettings.Items = new string[] { "15", "25", "50" };
        settings.SettingsPager.PageSize = 25;

        settings.CommandColumn.Visible = false;

        settings.SettingsSelection.Enabled = false;
        settings.SettingsSelection.AllowSelectAll = false;
        settings.SettingsSelection.Recursive = true;

        settings.SettingsBehavior.AllowSort = false;
        settings.SettingsBehavior.AllowFocusedNode = true;
        settings.SettingsBehavior.AllowDragDrop = false;
        settings.SettingsBehavior.FocusNodeOnLoad = false;
        settings.SettingsBehavior.AutoExpandAllNodes = false;
        settings.SettingsBehavior.ColumnResizeMode = ColumnResizeMode.NextColumn;

        settings.Styles.AlternatingNode.Enabled = DevExpress.Utils.DefaultBoolean.True;
        settings.KeyboardSupport = true;

        /*Events*/
        settings.ClientSideEvents.EndCallback = "TreeEndCallbackFocusToAddNew";
        settings.ClientSideEvents.NodeDblClick = "NodeDoubleClickToEdit";
        settings.ClientSideEvents.FocusedNodeChanged = "NodeFocusedChangedToSave";
        settings.ClientSideEvents.ContextMenu = "ShowTreeContextMenu";
        settings.ClientSideEvents.NodeClick = "function (s, e){ currentControlType = 'Tree';currentControl = DiaPhuongTreeList ; }";


        /*Fields*/
        settings.KeyFieldName = "DiaPhuong_Id";
        settings.ParentFieldName = "DiaPhuong_ParentId";
        settings.Columns.Add(
        column =>
        {
            column.FieldName = "TenDiaPhuong";
            column.Caption = "Tên địa phương";
            column.Width = Unit.Percentage(20);
        });
        settings.Columns.Add(
        column =>
        {
            column.FieldName = "IDBanDo";
            column.Caption = "Mã bản đồ";
            column.Width = Unit.Percentage(40);
        });
        settings.Columns.Add(
        column =>
        {
            column.FieldName = "Loai";
            column.Caption = "Phân loại";
            column.Width = Unit.Percentage(20);
            column.ColumnType = MVCxTreeListColumnType.ComboBox;

            var properties = column.PropertiesEdit as ComboBoxProperties;
            properties.Items.Add("Nước", "N");
            properties.Items.Add("Vùng, Khu vực", "V");
            properties.Items.Add("Tỉnh, Thành phố", "P");
            properties.Items.Add("Quận, Huyện", "D");
            properties.Items.Add("Xã, Phường, Thị Trấn", "W");
        });
        settings.Columns.Add(
        column =>
        {
            column.FieldName = "Longitude";
            column.Caption = "Kinh độ";
            column.Width = Unit.Percentage(10);
        });
        settings.Columns.Add(
        column =>
        {
            column.FieldName = "Latitude";
            column.Caption = "Vĩ độ";
            column.Width = Unit.Percentage(10);
        });
        settings.Columns.Add(
        column =>
        {
            column.FieldName = "TelCode";
            column.SortIndex = 0;
            column.SortOrder = DevExpress.Data.ColumnSortOrder.Ascending;
            column.Width = Unit.Percentage(10);
        }); 
    });
    if (ViewData["EditError"] != null)
    {
        treeList.SetEditErrorText((string)ViewData["EditError"]);
    }
}
@treeList.Bind(Model).GetHtml()