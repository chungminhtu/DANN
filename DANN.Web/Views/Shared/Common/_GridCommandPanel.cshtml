<script type="text/javascript">
    var control = null;


    //Tự động focus vào item mới thêm vào để nhập nhanh dữ liệu
    function GridEndCallback(s, e) {
        if (ctree.IsEditing()) {
            ctree.FocusEditor(0);
        }
    }

    //Kích đúp thì sẽ edit row trực tiếp
    function GridDoubleClick(s, e) {
        control.StartEditRow(control.GetFocusedRowIndex());
    }

    //Tự động lưu sau khi focus sang nút khác
    //function GridFocusedChanged(s, e) {
    //    var editor0 = "#" + ctree.name + "_DXEDITOR0_I";
    //    var editor1 = "#" + ctree.name + "_DXEDITOR1_I";

    //    if ($(editor0).val() == "" && $(editor1).val() == "") {
    //        ctree.CancelEdit();
    //    }
    //    else {
    //        ctree.UpdateEdit();
    //    }
    //}

</script>

@Html.DevExpress().Panel(panelButton =>
        {
            panelButton.Name = "PanelGridCommandCommon";
            panelButton.FixedPosition = PanelFixedPosition.None;
            panelButton.SettingsCollapsing.ExpandEffect = PanelExpandEffect.Auto;

            panelButton.SetContent(() =>
            {
                Html.DevExpress().Button(
                    myButton =>
                    {
                        myButton.Name = "btnThemMoi";
                        myButton.Text = "Thêm";
                        myButton.ControlStyle.Border.BorderWidth = Unit.Pixel(0);
                        myButton.Images.Image.Url = "~/Content/icon/16/Add_16x16.png";
                        myButton.ClientSideEvents.Click = "function(s, e) { control.AddNewRow(); }";
                        //myButton.Enabled = !ReferenceEquals(Session["ID_BenhNhan"], "");
                        myButton.Style[HtmlTextWriterStyle.MarginLeft] = "5px";
                    }).GetHtml();
                Html.DevExpress().Button(
                        myButton =>
                        {
                            myButton.Name = "btnSua";
                            myButton.Text = "Sửa (Enter)";
                            myButton.ControlStyle.Border.BorderWidth = Unit.Pixel(0);
                            myButton.Images.Image.Url = "~/Content/icon/16/Edit_16x16.png";
                            myButton.ClientSideEvents.Click = "function( ) { control.StartEditRow(control.GetFocusedRowIndex()); }";
                            //myButton.Enabled = !ReferenceEquals(Session["ID_BenhNhan"], "");
                            myButton.Style[HtmlTextWriterStyle.MarginLeft] = "5px";
                        }).GetHtml();
                Html.DevExpress().Button(
                        myButton =>
                        {
                            myButton.Name = "btnXoa";
                            myButton.Text = "Xóa (Delete)";
                            myButton.ControlStyle.Border.BorderWidth = Unit.Pixel(0);
                            myButton.Images.Image.Url = "~/Content/icon/16/Close_16x16.png";
                            myButton.ClientSideEvents.Click = "function( ) { if(confirm('Bạn có chắc chắn xóa dữ liệu này không?')) control.DeleteRow(control.GetFocusedRowIndex()); }";
                            myButton.Enabled = !ReferenceEquals(Session["ID_BenhNhan"], "");
                            myButton.Style[HtmlTextWriterStyle.MarginLeft] = "5px";
                        }).GetHtml();
                Html.DevExpress().Button(
                        myButton =>
                        {
                            myButton.Name = "btnLuu";
                            myButton.Text = "Lưu (Enter)";
                            myButton.ControlStyle.Border.BorderWidth = Unit.Pixel(0);
                            myButton.Images.Image.Url = "~/Content/icon/16/SaveAll_16x16.png";
                            myButton.ClientSideEvents.Click = "function( ) { control.UpdateEdit(); }";
                            myButton.Enabled = !ReferenceEquals(Session["ID_BenhNhan"], "");
                            myButton.Style[HtmlTextWriterStyle.MarginLeft] = "5px";
                        }).GetHtml();
                Html.DevExpress().Button(
                        myButton =>
                        {
                            myButton.Name = "btnHuy";
                            myButton.Text = "Hủy (ESC)";
                            myButton.ControlStyle.Border.BorderWidth = Unit.Pixel(0);
                            myButton.Images.Image.Url = "~/Content/icon/16/Reset2_16x16.png";
                            myButton.ClientSideEvents.Click = "function( ) { control.CancelEdit();  }";
                            myButton.Enabled = !ReferenceEquals(Session["ID_BenhNhan"], "");
                            myButton.Style[HtmlTextWriterStyle.MarginLeft] = "5px";
                        }).GetHtml();
                Html.DevExpress().Button(
                        myButton =>
                        {
                            myButton.Name = "btnRefresh";
                            myButton.Text = "Xem thay đổi (F5)";
                            myButton.Images.Image.Url = "~/Content/icon/16/DocumentMap_16x16.png";
                            myButton.ClientSideEvents.Click = "function( ) { location.reload();  }";
                            myButton.ControlStyle.Border.BorderWidth = Unit.Pixel(0);
                            myButton.Style[HtmlTextWriterStyle.MarginLeft] = "5px";
                            myButton.Enabled = !ReferenceEquals(Session["ID_BenhNhan"], "");
                        }).GetHtml();
            });
        }).GetHtml()
